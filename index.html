<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Editor and Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <h1>PDF Editor and Generator</h1>
    <div id="content" contenteditable="true" style="border:1px solid #000; padding:10px;">
        <p>Type your content here...</p>
    </div>
    <button id="generatePDF">Generate PDF</button>

    <script>
        document.getElementById('generatePDF').addEventListener('click', async () => {
            const { PDFDocument } = PDFLib;

            // Capture the content from the editable div
            const content = document.getElementById('content');
            const canvas = await html2canvas(content);
            const imgData = canvas.toDataURL('image/png');

            // Create a new PDFDocument
            const pdfDoc = await PDFDocument.create();
            const page = pdfDoc.addPage([canvas.width, canvas.height]);

            // Embed the image in the PDF document
            const img = await pdfDoc.embedPng(imgData);
            page.drawImage(img, {
                x: 0,
                y: 0,
                width: canvas.width,
                height: canvas.height,
            });

            // Serialize the PDFDocument to bytes (a Uint8Array)
            const pdfBytes = await pdfDoc.save();

            // Trigger the browser to download the PDF document
            const blob = new Blob([pdfBytes], { type: 'application/pdf' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'generated.pdf';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        });
    </script>
</body>
</html>